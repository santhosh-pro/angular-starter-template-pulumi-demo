name: Demo One API Development

on:
  push:
    branches: [ master ]
jobs:
  docker-build:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - name: Build Docker
      run: |
        docker build -t ghcr.io/santhoshprogrammer94/ng-pulumi-demo:$GITHUB_SHA .
      env:
        CI: true
    - name: Publish Docker
      env:
        CI: true
        DOCKER_USERNAME: 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
        DOCKER_PASSWORD: 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
      run: |
        docker login -u $DOCKER_USERNAME -p $DOCKER_PASSWORD ghcr.io
        docker push ghcr.io/santhoshprogrammer94/ng-pulumi-demo:$GITHUB_SHA